此 `rollup.config.js` 配置文件适用于对 TypeScript 项目进行打包编译，产物可直接发布 npm。

依赖项：

```bash
npm add -D @rollup/plugin-terser @rollup/plugin-typescript rollup-plugin-delete rollup-plugin-dts
```

配置如下：

```typescript
const terser = require('@rollup/plugin-terser')
const typescript = require('@rollup/plugin-typescript')
const del = require('rollup-plugin-delete')
const { dts } = require('rollup-plugin-dts')

/** @type {import('rollup').RollupOptions} */
module.exports = [
  // 通过 rollup-plugin-delete 工具先提前把 dist 目录清空
  // 通过 rollup-plugin-dts 输出 index.d.ts
  // 因为这个工具可以把所有类型定义合并成一个
  {
    input: 'src/index.ts',
    output: { file: './dist/index.d.ts', format: 'es' },
    plugins: [del({ targets: './dist/*' }), dts()],
  },

  // 分别输出 CommonJS 和 ES Module 两种格式的产物
  {
    input: ['src/index.ts'],
    output: [
      { format: 'cjs', file: './dist/index.cjs.js' },
      { format: 'es', file: './dist/index.esm.js' },
    ],
    plugins: [typescript({ declaration: false })],
  },

  // 输出 UMD 格式的产物
  // 注意 UMD 格式必须提供一个全局名称，例如 jQuery 或 $
  // 这样才能在浏览器 <script> 引入时把你的库导入到全局变量
  {
    input: ['src/index.ts'],
    output: {
      format: 'umd',
      file: './dist/index.umd.js',
      name: '<全局名>',
    },
    plugins: [
      typescript({ declaration: false }),
      // UMD 模块已经是最终产物了，打包时直接压缩
      terser(),
    ],
  },
]
```

每一项配置请参考其中的注释。

注意，如果你用到了某个 CommonJS 导出格式的依赖，那么你还需要添加 `@rollup/plugin-commonjs` 插件。

---

如果 `rollup-plugin-dts` 在 Monorepo 仓库中遇到问题，可以这样配置：

```typescript
dts({ compilerOptions: { preserveSymlinks: false } })
```
